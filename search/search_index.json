{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Documentation Essensys Support Site","text":"<p>Bienvenue sur la documentation technique du site de support Essensys.</p> <p>Ce projet se compose de : - Un Backend en Go (Golang) utilisant Chi Router. - Un Frontend en React (Vite). - Une infrastructure h\u00e9berg\u00e9e sur VPS (Ubuntu) avec Nginx et PostgreSQL.</p>"},{"location":"#navigation","title":"Navigation","text":"<ul> <li>Configuration Syst\u00e8me : Base de donn\u00e9es, Backups, Variables d'environnement.</li> <li>Authentification : Configuration OAuth (Google, Apple).</li> </ul>"},{"location":"audit_trail/","title":"Audit Trail (Journaux d'Activit\u00e9)","text":"<p>La fonctionnalit\u00e9 Audit Trail permet de tracer les actions critiques effectu\u00e9es sur la plateforme pour des raisons de s\u00e9curit\u00e9 et de conformit\u00e9.</p>"},{"location":"audit_trail/#evenements-enregistres","title":"\u00c9v\u00e9nements Enregistr\u00e9s","text":"<p>Le syst\u00e8me enregistre automatiquement les \u00e9v\u00e9nements suivants :</p> <ul> <li>Authentification :<ul> <li><code>LOGIN</code> : Connexion r\u00e9ussie.</li> <li><code>LOGIN_FAILED</code> : \u00c9chec de connexion (mauvais mot de passe, utilisateur inconnu).</li> <li><code>REGISTER</code> : Inscription d'un nouvel utilisateur.</li> <li><code>LOGOUT</code> : D\u00e9connexion (explicite).</li> </ul> </li> <li>Administration :<ul> <li><code>UPDATE_ROLE</code> : Modification du r\u00f4le d'un utilisateur.</li> <li><code>CREATE_USER</code> : Cr\u00e9ation manuelle d'un utilisateur par un admin.</li> </ul> </li> </ul>"},{"location":"audit_trail/#donnees-collectees","title":"Donn\u00e9es Collect\u00e9es","text":"<p>Pour chaque \u00e9v\u00e9nement, nous stockons : *   Date/Heure de l'\u00e9v\u00e9nement. *   Utilisateur (Nom d'utilisateur/Email et ID). *   Adresse IP source. *   Action (Type d'op\u00e9ration). *   D\u00e9tails (Description contextuelle, valeurs avant/apr\u00e8s si applicable).</p>"},{"location":"audit_trail/#acces-et-permissions","title":"Acc\u00e8s et Permissions","text":"<p>L'acc\u00e8s aux journaux d'audit est en lecture seule et restreint selon le r\u00f4le :</p> <ul> <li>Global Admin (<code>admin_global</code>) : Acc\u00e8s \u00e0 tous les journaux de la plateforme.</li> <li>Local Admin (<code>admin_local</code>) : Acc\u00e8s restreint aux journaux concernant les utilisateurs li\u00e9s \u00e0 sa machine locale (armoire Essensys).</li> <li>User (<code>user</code>) : Acc\u00e8s restreint \u00e0 ses propres actions uniquement.</li> <li>Autres : Aucun acc\u00e8s.</li> </ul> <p>Ces r\u00e8gles garantissent que chaque administrateur local ne voit que ce qui concerne son p\u00e9rim\u00e8tre.</p>"},{"location":"authentication/","title":"Authentification OAuth","text":"<p>Le support site utilise OAuth2 pour authentifier les administrateurs. Deux fournisseurs sont support\u00e9s : Google et Apple.</p> <p>[!IMPORTANT] Seules les adresses emails list\u00e9es dans la variable <code>ADMIN_EMAILS</code> du fichier <code>.env</code> sont autoris\u00e9es \u00e0 se connecter.</p>"},{"location":"authentication/#google-oauth","title":"Google OAuth","text":""},{"location":"authentication/#configuration-google-cloud-console","title":"Configuration Google Cloud Console","text":"<ol> <li>Cr\u00e9er un projet sur la Google Cloud Console.</li> <li>Configurer l'\u00e9cran de consentement OAuth (User Type: Externe).</li> <li>Cr\u00e9er des identifiants Client OAuth 2.0.</li> <li>URIs de redirection autoris\u00e9s :    Il est imp\u00e9ratif d'ajouter l'URL exacte de callback :    <code>https://mon.essensys.fr/api/auth/google/callback</code></li> </ol>"},{"location":"authentication/#variables-env","title":"Variables <code>.env</code>","text":"<ul> <li><code>GOOGLE_CLIENT_ID</code>: L'ID Client fourni par Google.</li> <li><code>GOOGLE_CLIENT_SECRET</code>: Le Code Secret Client.</li> <li><code>GOOGLE_REDIRECT_URL</code>: L'URL compl\u00e8te de callback (doit correspondre \u00e0 celle d\u00e9clar\u00e9e sur Google).</li> </ul>"},{"location":"authentication/#apple-oauth-sign-in-with-apple","title":"Apple OAuth (Sign In with Apple)","text":"<p>Apple est plus complexe car il n\u00e9cessite une cl\u00e9 priv\u00e9e <code>.p8</code> et g\u00e8re les callbacks en m\u00e9thode <code>POST</code>.</p>"},{"location":"authentication/#configuration-apple-developer-portal","title":"Configuration Apple Developer Portal","text":"<ol> <li>Cr\u00e9er un App ID (ex: <code>fr.essensys.app</code>).</li> <li>Cr\u00e9er un Service ID (ex: <code>fr.essensys.web</code>).</li> <li>Activer \"Sign In with Apple\".</li> <li>Dans \"Configure\", lier \u00e0 l'App ID principal.</li> <li>Domains and Subdomains : <code>mon.essensys.fr</code> (sans https).</li> <li>Return URLs : <code>https://mon.essensys.fr/api/auth/apple/callback</code>.</li> <li>V\u00e9rifier le domaine :</li> <li>T\u00e9l\u00e9charger le fichier de v\u00e9rification Apple.</li> <li>Le placer dans le dossier servi par Nginx pour qu'il soit accessible via <code>https://mon.essensys.fr/.well-known/apple-developer-domain-association.txt</code>.</li> <li>Cr\u00e9er une Key (Cl\u00e9 Priv\u00e9e) :</li> <li>Cocher \"Sign in with Apple\".</li> <li>T\u00e9l\u00e9charger le fichier <code>.p8</code> (Attention, t\u00e9l\u00e9chargeable une seule fois !).</li> <li>Noter le Key ID.</li> </ol>"},{"location":"authentication/#variables-env_1","title":"Variables <code>.env</code>","text":"<ul> <li><code>APPLE_TEAM_ID</code>: Votre Team ID Apple (ex: <code>J32285QB9J</code>).</li> <li><code>APPLE_CLIENT_ID</code>: Le Service ID cr\u00e9\u00e9 \u00e0 l'\u00e9tape 2 (ex: <code>fr.essensys.web</code>).</li> <li><code>APPLE_KEY_ID</code>: L'ID de la cl\u00e9 (\u00e9tape 4).</li> <li><code>APPLE_KEY_FILE</code>: Chemin absolu vers le fichier <code>.p8</code> sur le serveur (ex: <code>/home/ubuntu/AuthKey_xxxx.p8</code>).</li> <li><code>APPLE_REDIRECT_URL</code>: L'URL compl\u00e8te de callback.</li> </ul> <p>[!WARNING] Apple renvoie la r\u00e9ponse d'authentification via une requ\u00eate POST. Le Backend a \u00e9t\u00e9 configur\u00e9 pour g\u00e9rer sp\u00e9cifiquement ce cas (Cookie <code>SameSite=None</code>), mais cela peut causer des erreurs 405 si Nginx ou le routeur bloquent les POST sur cette URL.</p>"},{"location":"configuration/","title":"Configuration Syst\u00e8me","text":""},{"location":"configuration/#base-de-donnees-postgresql","title":"Base de Donn\u00e9es (PostgreSQL)","text":"<p>Le backend utilise PostgreSQL pour stocker les donn\u00e9es persistantes. L'installation est automatis\u00e9e via le script <code>./install.sh</code>.</p> <ul> <li>Utilisateur : <code>essensys</code></li> <li>Base de donn\u00e9es : <code>essensys</code></li> <li>Port : 5432 (port par d\u00e9faut, accessible uniquement en localhost pour s\u00e9curit\u00e9)</li> </ul> <p>Si vous devez y acc\u00e9der manuellement sur le VPS :</p> <pre><code>sudo -u postgres psql -d essensys\n</code></pre>"},{"location":"configuration/#sauvegardes-backups","title":"Sauvegardes (Backups)","text":"<p>Une strat\u00e9gie de sauvegarde automatique est configur\u00e9e par le script d'installation.</p> <ul> <li>Fr\u00e9quence : Quotidienne (tous les jours \u00e0 03h00 du matin).</li> <li>Emplacement : <code>/var/backups/essensys/</code></li> <li>R\u00e9tention : 200 jours (les fichiers plus vieux sont supprim\u00e9s automatiquement).</li> <li>Format : Fichiers compress\u00e9s <code>.sql.gz</code> contenant un dump complet de la base.</li> </ul>"},{"location":"configuration/#restauration","title":"Restauration","text":"<p>Pour restaurer un backup : 1. D\u00e9compresser le fichier : <code>gunzip essensys_db_YYYYMMDD_HHMMSS.sql.gz</code> 2. Restaurer : <code>psql -U essensys -d essensys &lt; essensys_db_YYYYMMDD_HHMMSS.sql</code></p>"},{"location":"configuration/#variables-denvironnement-env","title":"Variables d'Environnement (<code>.env</code>)","text":"<p>Le fichier <code>.env</code> situ\u00e9 dans <code>backend/</code> (et lu par systemd) configure l'application. Le fichier <code>.env.template</code> sert de r\u00e9f\u00e9rence.</p>"},{"location":"configuration/#configuration-generale","title":"Configuration G\u00e9n\u00e9rale","text":"<ul> <li><code>PORT</code>: Port d'\u00e9coute du backend (ex: 8080).</li> <li><code>FRONTEND_URL</code>: URL publique du frontend (ex: <code>https://mon.essensys.fr/</code>).</li> </ul>"},{"location":"configuration/#base-de-donnees","title":"Base de Donn\u00e9es","text":"<ul> <li><code>DB_HOST</code>: Host de la DB (ex: <code>localhost</code>).</li> <li><code>DB_PORT</code>: Port (ex: 5432).</li> <li><code>DB_USER</code>: Utilisateur DB (ex: <code>essensys</code>).</li> <li><code>DB_PASSWORD</code>: Mot de passe DB.</li> <li><code>DB_NAME</code>: Nom de la base (ex: <code>essensys</code>).</li> </ul>"},{"location":"configuration/#smtp-emails","title":"SMTP (Emails)","text":"<ul> <li><code>SMTP_HOST</code>: Serveur SMTP (ex: <code>mail.infomaniak.com</code>).</li> <li><code>SMTP_PORT</code>: Port SMTP (ex: 465 ou 587).</li> <li><code>SMTP_USER</code>: Email d'envoi.</li> <li><code>SMTP_PASS</code>: Mot de passe SMTP.</li> <li><code>SMTP_FROM</code>: Alias d'envoi (optionnel).</li> </ul>"},{"location":"configuration/#securite-admin","title":"S\u00e9curit\u00e9 Admin","text":"<ul> <li><code>ADMIN_TOKEN</code>: Token statique pour les acc\u00e8s legacy.</li> <li><code>ADMIN_EMAILS</code>: Liste blanche des emails autoris\u00e9s \u00e0 se connecter via OAuth (Google/Apple). S\u00e9par\u00e9s par des virgules.</li> <li>Exemple : <code>admin@example.com,dev@example.com</code></li> <li><code>JWT_SECRET</code>: Cl\u00e9 secr\u00e8te longue et al\u00e9atoire pour signer les tokens de session.</li> </ul>"},{"location":"features/","title":"Features","text":""},{"location":"features/#user-profile-device-linking","title":"User Profile &amp; Device Linking","text":"<p>The User Profile feature allows users to associate their account with specific Essensys hardware (Machines and Gateways). This enables personalized interactions and remote management capabilities.</p>"},{"location":"features/#device-discovery","title":"Device Discovery","text":"<p>When a user visits their profile page, the system automatically detects Essensys devices on the same local network (based on public IP matching).</p> <ul> <li>Machines (Cabinets): Identified by Serial Number.</li> <li>Gateways: Identified by Hostname.</li> </ul>"},{"location":"features/#linking-process","title":"Linking Process","text":"<ol> <li>Navigate to the Profil page via the header menu.</li> <li>The \"Mes Appareils\" section displays currently linked devices.</li> <li>Use the dropdowns to select a detected Machine or Gateway.</li> <li>Click Enregistrer.</li> </ol> <p>Note: For security reasons, regular users can only link devices that are detected on the same IP address as their current connection.</p>"},{"location":"features/#admin-user-management","title":"Admin User Management","text":"<p>Administrators have access to a dedicated Dashboard for managing users and system configuration.</p>"},{"location":"features/#user-manager","title":"User Manager","text":"<p>Located in the Admin &gt; Utilisateurs tab.</p> <ul> <li>List Users: View all registered users, their emails, roles, and creation dates.</li> <li>Role Assignment: Promote users to <code>Support</code> or <code>Admin</code> roles directly from the list.</li> <li>Device Management:<ul> <li>Admins can view keys linked to any user.</li> <li>Click Lier Appareils to open a modal where you can manually assign ANY Machine or Gateway to a user, overriding IP restrictions.</li> </ul> </li> </ul>"},{"location":"features/#creating-users","title":"Creating Users","text":"<p>Admins can manually register new users via the \"Ajouter un Utilisateur\" form in the User Manager, useful for setting up support staff or pre-provisioning accounts.</p>"},{"location":"privacy_policy/","title":"Politique de Confidentialit\u00e9","text":"<p>Derni\u00e8re mise \u00e0 jour : 18 Janvier 2026</p> <p>Bienvenue sur la plateforme de support Essensys. Nous nous engageons \u00e0 prot\u00e9ger vos donn\u00e9es personnelles conform\u00e9ment au R\u00e8glement G\u00e9n\u00e9ral sur la Protection des Donn\u00e9es (RGPD).</p>"},{"location":"privacy_policy/#1-responsable-du-traitement","title":"1. Responsable du traitement","text":"<p>Essensys [Adresse] Contact : support@essensys.fr</p>"},{"location":"privacy_policy/#2-donnees-collectees","title":"2. Donn\u00e9es collect\u00e9es","text":"<p>Nous collectons uniquement les donn\u00e9es n\u00e9cessaires au fonctionnement du service : *   Identit\u00e9 : Nom, Pr\u00e9nom, Adresse email. *   Technique : Adresse IP, Logs de connexion et d'actions (Audit Trail). *   Appareils : Identifiants des armoires et passerelles li\u00e9es \u00e0 votre compte.</p>"},{"location":"privacy_policy/#3-finalite-du-traitement","title":"3. Finalit\u00e9 du traitement","text":"<ul> <li>Gestion de compte : Authentification et acc\u00e8s aux services.</li> <li>S\u00e9curit\u00e9 : Surveillance des acc\u00e8s et tra\u00e7abilit\u00e9 des actions sensibles (Audit Trail).</li> <li>Support : Association technique entre votre compte et vos \u00e9quipements.</li> </ul>"},{"location":"privacy_policy/#4-vos-droits","title":"4. Vos Droits","text":"<p>Conform\u00e9ment au RGPD, vous disposez des droits suivants : *   Droit d'acc\u00e8s : Voir vos informations personnelles et votre historique (disponible dans \"Mon Profil\"). *   Droit de rectification : Modifier vos informations (disponible dans \"Mon Profil\"). *   Droit \u00e0 l'oubli : Supprimer votre compte (disponible dans \"Mon Profil\"). *   Droit \u00e0 la portabilit\u00e9 : Exporter vos donn\u00e9es (disponible dans \"Mon Profil\").</p>"},{"location":"privacy_policy/#5-cookies","title":"5. Cookies","text":"<p>Nous utilisons uniquement des cookies techniques n\u00e9cessaires au maintien de votre session (\"Remember Me\").</p>"},{"location":"privacy_policy/#6-contact","title":"6. Contact","text":"<p>Pour toute demande, vous pouvez nous contacter via le support ou \u00e0 l'adresse support@essensys.fr.</p>"},{"location":"roles_matrix/","title":"Matrice des R\u00f4les et Permissions","text":"<p>Ce document d\u00e9taille les diff\u00e9rents r\u00f4les disponibles sur la plateforme Essensys Support et leurs privil\u00e8ges respectifs.</p>"},{"location":"roles_matrix/#definitions-des-roles","title":"D\u00e9finitions des R\u00f4les","text":"R\u00f4le Cde Technique Description P\u00e9rim\u00e8tre Global Admin <code>admin_global</code> Super-administrateur avec acc\u00e8s complet. Ensemble de la plateforme (Toutes les machines, tous les utilisateurs). Local Admin <code>admin_local</code> Administrateur d'une installation locale. Limit\u00e9 \u00e0 la machine/armoire physique o\u00f9 il est connect\u00e9 (IP). User <code>user</code> Utilisateur standard valid\u00e9. Acc\u00e8s aux fonctionnalit\u00e9s de support et pilotage de ses appareils. Guest Local <code>guest_local</code> Visiteur non valid\u00e9 sur le r\u00e9seau local. Acc\u00e8s en lecture seule \u00e0 la machine locale (pour d\u00e9couverte)."},{"location":"roles_matrix/#matrice-raci-fonctionnalites","title":"Matrice RACI / Fonctionnalit\u00e9s","text":"<p>Le tableau ci-dessous indique qui peut faire quoi (R = Responsible/Access, - = No Access).</p> Fonctionnalit\u00e9 Admin Global Admin Local User Guest Local Acc\u00e8s Dashboard Admin \u2705 \u2705 \u274c \u274c Voir Stats Globales \u2705 \u2705 \u274c \u274c Voir liste TOUS les utilisateurs \u2705 \u274c \u274c \u274c Voir liste utilisateurs LOCAUX \u2705 \u2705 \u274c \u274c Modifier r\u00f4le n'importe qui \u2705 \u274c \u274c \u274c Promouvoir Guest -&gt; User (Local) \u2705 \u2705 \u274c \u274c Lier Machine/Gateway (Force) \u2705 \u274c \u274c \u274c Voir Carte G\u00e9olocalisation \u2705 \u2705 \u274c \u274c G\u00e9rer Newsletters \u2705 \u2705 \u274c \u274c Voir Audit Trail \u2705 \u2705 (Local) \u2705 (Perso) \u274c Acc\u00e8s Support / Tickets \u2705 \u2705 \u2705 \u274c Voir Profil / Appareils li\u00e9s \u2705 \u2705 \u2705 \u2705"},{"location":"roles_matrix/#details-specifiques","title":"D\u00e9tails Sp\u00e9cifiques","text":""},{"location":"roles_matrix/#attribution-automatique-des-roles","title":"Attribution Automatique des R\u00f4les","text":"<p>Lors de l'inscription : 1. Liaison Machine : Si l'utilisateur s'inscrit depuis l'IP d'une machine Essensys connue, il est automatiquement li\u00e9 \u00e0 cette machine. 2. Premier Arriv\u00e9 (Admin Local) : Si la machine n'a pas encore d'administrateur local, le premier utilisateur devient automatiquement <code>admin_local</code>. 3. Suivants (Guest Local) : Les utilisateurs suivants sur la m\u00eame machine deviennent par d\u00e9faut <code>guest_local</code>. Ils doivent \u00eatre valid\u00e9s par l'Admin Local (pass\u00e9s en <code>user</code>).</p>"},{"location":"roles_matrix/#admin_local","title":"admin_local","text":"<ul> <li>Ne voit que les utilisateurs li\u00e9s \u00e0 la m\u00eame machine que lui.</li> <li>Ne peut modifier les r\u00f4les que des utilisateurs de sa machine.</li> <li>Ne peut pas s'auto-promouvoir <code>admin_global</code>.</li> </ul>"}]}